<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main}">
<body>
  <section layout:fragment="content" th:with="novo=${cacamba.id == null}">
    <h1 th:text="${novo} ? 'Nova Caçamba' : 'Editar Caçamba'"></h1>

    <form th:action="${novo} ? @{/ui/cacambas} : @{/ui/cacambas/{id}(id=${cacamba.id})}"
          th:object="${cacamba}" method="post" class="row g-3 needs-validation" novalidate>

      <div class="col-md-6">
        <label class="form-label">Código</label>
        <input type="text" class="form-control" th:field="*{codigo}" required>
        <div class="invalid-feedback" th:errors="*{codigo}"></div>
      </div>

      <div class="col-md-3">
        <label class="form-label">Capacidade (m³)</label>
        <input type="number" class="form-control" th:field="*{capacidadeM3}" required>
        <div class="invalid-feedback" th:errors="*{capacidadeM3}"></div>
      </div>

      <div class="col-md-3">
        <label class="form-label">Status</label>
        <select class="form-select" th:field="*{status}" required>
          <option th:each="s : ${T(com.eccolimp.cacamba_manager.domain.model.StatusCacamba).values()}"
                  th:value="${s}" th:text="${s}">DISPONIVEL</option>
        </select>
      </div>

      <div class="col-12">
        <button class="btn btn-success" type="submit">Salvar</button>
        <a class="btn btn-secondary" th:href="@{/ui/cacambas}">Cancelar</a>
      </div>
    </form>
  </section>

  <script>
    // Bootstrap client-side validation
    (() => {
       'use strict';
       const forms = document.querySelectorAll('.needs-validation');
       Array.from(forms).forEach(form => {
         form.addEventListener('submit', event => {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
         }, false);
       });
    })();
  </script>
</body>
</html>